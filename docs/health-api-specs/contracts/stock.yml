openapi: 3.0.1
info:
  title: Stock Service
  version: v1.6
servers:
  - url: https://unified-qa.digit.org
    description: Development server url
paths:
  /stock/v1/_create:
    post:
      tags:
        - Stock
      summary: Create/Add a new record for transfer of product variant stock
      description: Create/Add a new record for transfer of product variant stock
      operationId: stockV1CreatePost_1
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StockRequest'
        required: true
        
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/StockResponse'
        '400':
          description: Invalid Input body.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
  /stock/v1/bulk/_create:
    post:
      tags:
        - Stock
      summary: Create/Add a new record for transfer of product variant stock in bulk
      description: Create/Add a new record for transfer of product variant stock in bulk
      operationId: stockV1CreatePost
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StockBulkRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ResponseInfo'
        '400':
          description: Invalid Input body.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
  /stock/v1/_update:
    post:
      tags:
        - Stock
      summary: Update record for transfer of a stock transaction
      description: Update record for transfer of a stock transaction
      operationId: stockV1UpdatePost_1
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StockRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/StockResponse'
        '400':
          description: Invalid Input body.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
  /stock/v1/bulk/_update:
    post:
      tags:
        - Stock
      summary: Update records for transfer of a stock transaction in bulk
      description: Update records for transfer of a stock transaction in bulk
      operationId: stockV1UpdatePost
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StockBulkRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ResponseInfo'
        '400':
          description: Invalid Input body.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
  /stock/v1/_delete:
    post:
      tags:
        - Stock
      summary: Soft delete record for transfer of a stock transaction
      description: Soft delete record for transfer of a stock transaction
      operationId: stockV1DeletePost_1
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StockRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/StockResponse'
        '400':
          description: Invalid Input body.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
  /stock/v1/bulk/_delete:
    post:
      tags:
        - Stock
      summary: Soft delete records for transfer of a stock transaction
      description: Soft delete records for transfer of a stock transaction
      operationId: stockV1DeletePost
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StockBulkRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ResponseInfo'
        '400':
          description: Invalid Input body.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes

  /stock/v1/_search:
    post:
      tags:
        - Stock
      summary: Search for stock transaction
      description: Search for stock transaction based on given criteria
      operationId: stockV1SearchPost
      parameters:
        - $ref: "#/components/parameters/limit"
        - $ref: "#/components/parameters/offset"
        - $ref: "#/components/parameters/tenantId"
        - $ref: "#/components/parameters/lastChangedSince"
        - $ref: "#/components/parameters/includeDeleted"
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StockSearchRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/StockBulkResponse'
        '400':
          description: Invalid Input body.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes


  /stock/reconciliation/v1/_create:
    post:
      tags:
        - Stock Reconciliation
      summary: Create/Add a new stock reconciliation record for a product variant
      description: Create/Add a new stock reconciliation record for a product variant
      operationId: stockReconciliationV1CreatePost_1
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StockReconciliationRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/StockReconciliationResponse'
        '400':
          description: Invalid Input body.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
  /stock/reconciliation/v1/bulk/_create:
    post:
      tags:
        - Stock Reconciliation
      summary: Create/Add a new stock reconciliation record for a product variant in bulk
      description: Create/Add a new stock reconciliation record for a product variant in bulk
      operationId: stockReconciliationV1CreatePost
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StockReconciliationBulkRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ResponseInfo'
        '400':
          description: Invalid Input body.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
  /stock/reconciliation/v1/_update:
    post:
      tags:
        - Stock Reconciliation
      summary: Update stock reconciliation record
      description: Update stock reconciliation record
      operationId: stockReconciliationV1UpdatePost_1
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StockReconciliationRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/StockReconciliationResponse'
        '400':
          description: Invalid Input body.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
  /stock/reconciliation/v1/bulk/_update:
    post:
      tags:
        - Stock Reconciliation
      summary: Update stock reconciliation records in bulk
      description: Update stock reconciliation records in bulk
      operationId: stockReconciliationV1UpdatePost
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StockReconciliationBulkRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ResponseInfo'
        '400':
          description: Invalid Input body.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
  /stock/reconciliation/v1/_delete:
    post:
      tags:
        - Stock Reconciliation
      summary: Soft delete stock reconciliation record
      description: Soft delete stock reconciliation record
      operationId: stockReconciliationV1DeletePost_1
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StockReconciliationRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/StockReconciliationResponse'
        '400':
          description: Invalid Input body.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
  /stock/reconciliation/v1/bulk/_delete:
    post:
      tags:
        - Stock Reconciliation
      summary: Soft delete stock reconciliation records in bulk
      description: Soft delete stock reconciliation records in bulk
      operationId: stockReconciliationV1DeletePost
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StockReconciliationBulkRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ResponseInfo'
        '400':
          description: Invalid Input body.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
  /stock/reconciliation/v1/_search:
    post:
      tags:
        - Stock Reconciliation
      summary: Search for stock reconciliation record
      description: Search for stock reconciliation record
      operationId: stockReconciliationV1SearchPost
      parameters:
        - $ref: "#/components/parameters/limit"
        - $ref: "#/components/parameters/offset"
        - $ref: "#/components/parameters/tenantId"
        - $ref: "#/components/parameters/lastChangedSince"
        - $ref: "#/components/parameters/includeDeleted"
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StockReconciliationSearchRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/StockReconciliationBulkResponse'
        '400':
          description: Invalid Input body.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
    
components:
  parameters:
    tenantId:
      name: tenantId
      in: query
      description: Unique id for a tenant.
      required: true
      schema:
        type: string
        format: varchar
  
    lastChangedSince:
      name: lastChangedSince
      in: query
      description: |
        Epoch of the time since when the changes on the object should be picked up. 
        Search results from this parameter should include both newly created objects 
        since this time as well as any modified objects since this time. 
      required: false
      schema:
        type: integer
        format: int64
  
    echoResource:
      name: echoResource
      in: query
      description: |
        Client can specify if the resource in request body needs to be sent back in the response.
      required: false
      schema:
        type: boolean
        default: true
  
    serverHandlesErrors:
      name: serverHandlesErrors
      in: query
      description: |
        Client can specify that it is incapable of handling any errors with the requests.
      required: false
      schema:
        type: boolean
        default: false
  
    limit:
      name: limit
      in: query
      description: Pagination - limit records in response
      required: true
      schema:
        type: integer
        minimum: 0
        maximum: 1000  # TODO: review
  
    offset:
      name: offset
      in: query
      description: Pagination - offset from which records should be returned in response
      required: true
      schema:
        type: integer
        minimum: 0
  
    includeDeleted:
      name: includeDeleted
      in: query
      description: Used in search APIs to specify if (soft) deleted records should be included in search results.
      required: false
      schema:
        type: boolean
        default: false

  schemas:
    AdditionalFields:
      type: object
      properties:
        schema:
          maxLength: 64
          minLength: 2
          type: string
        version:
          minimum: 1
          type: integer
          format: int32
        fields:
          type: array
          items:
            $ref: '#/components/schemas/Field'
    AuditDetails:
      type: object
      properties:
        createdBy:
          type: string
        lastModifiedBy:
          type: string
        createdTime:
          type: integer
          format: int64
        lastModifiedTime:
          type: integer
          format: int64
    Field:
      required:
        - key
        - value
      type: object
      properties:
        key:
          maxLength: 64
          minLength: 2
          type: string
        value:
          maxLength: 10000
          minLength: 1
          type: string
    PlainAccessRequest:
      type: object
      properties:
        recordId:
          type: string
        plainRequestFields:
          type: array
          items:
            type: string
    RequestInfo:
      type: object
      properties:
        apiId:
          type: string
        ver:
          type: string
        ts:
          type: integer
          format: int64
        action:
          type: string
        did:
          type: string
        key:
          type: string
        msgId:
          type: string
        authToken:
          type: string
        correlationId:
          type: string
        plainAccessRequest:
          $ref: '#/components/schemas/PlainAccessRequest'
        userInfo:
          $ref: '#/components/schemas/User'
    Role:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        code:
          type: string
        tenantId:
          type: string
    Stock:
      required:
        - productVariantId
        - quantity
        - receiverId
        - receiverType
        - referenceIdType
        - senderId
        - senderType
        - tenantId
        - transactionType
      type: object
      properties:
        id:
          maxLength: 64
          minLength: 2
          type: string
        tenantId:
          maxLength: 1000
          minLength: 2
          type: string
        source:
          type: string
        rowVersion:
          type: integer
          format: int32
        applicationId:
          type: string
        hasErrors:
          type: boolean
        additionalFields:
          $ref: '#/components/schemas/AdditionalFields'
        auditDetails:
          $ref: '#/components/schemas/AuditDetails'
        clientReferenceId:
          maxLength: 64
          minLength: 2
          type: string
        clientAuditDetails:
          $ref: '#/components/schemas/AuditDetails'
        productVariantId:
          maxLength: 64
          minLength: 2
          type: string
        quantity:
          maximum: 2147483647
          minimum: 1
          type: integer
          format: int32
        referenceId:
          type: string
        referenceIdType:
          type: string
          enum:
            - PROJECT
            - OTHER
        transactionType:
          type: string
          enum:
            - RECEIVED
            - DISPATCHED
        transactionReason:
          type: string
          enum:
            - RECEIVED
            - RETURNED
            - LOST_IN_STORAGE
            - LOST_IN_TRANSIT
            - DAMAGED_IN_STORAGE
            - DAMAGED_IN_TRANSIT
        senderId:
          maxLength: 64
          minLength: 2
          type: string
        senderType:
          type: string
          enum:
            - WAREHOUSE
            - STAFF
        receiverId:
          maxLength: 64
          minLength: 2
          type: string
        receiverType:
          type: string
          enum:
            - WAREHOUSE
            - STAFF
        wayBillNumber:
          maxLength: 200
          minLength: 2
          type: string
        isDeleted:
          type: boolean
        dateOfEntry:
          type: integer
          format: int64
    StockBulkRequest:
      required:
        - RequestInfo
        - Stock
      type: object
      properties:
        RequestInfo:
          $ref: '#/components/schemas/RequestInfo'
        Stock:
          type: array
          items:
            $ref: '#/components/schemas/Stock'
    User:
      type: object
      properties:
        id:
          type: integer
          format: int64
        userName:
          type: string
        name:
          type: string
        type:
          type: string
        mobileNumber:
          type: string
        emailId:
          type: string
        roles:
          type: array
          items:
            $ref: '#/components/schemas/Role'
        tenantId:
          type: string
        uuid:
          type: string
    ResponseInfo:
      type: object
      properties:
        apiId:
          type: string
        ver:
          type: string
        ts:
          type: integer
          format: int64
        resMsgId:
          type: string
        msgId:
          type: string
        status:
          type: string
    StockRequest:
      required:
        - RequestInfo
        - Stock
      type: object
      properties:
        RequestInfo:
          $ref: '#/components/schemas/RequestInfo'
        Stock:
          $ref: '#/components/schemas/Stock'
    StockResponse:
      required:
        - ResponseInfo
        - Stock
      type: object
      properties:
        ResponseInfo:
          $ref: '#/components/schemas/ResponseInfo'
        Stock:
          $ref: '#/components/schemas/Stock'
    URLParams:
      required:
        - limit
        - offset
        - tenantId
      type: object
      properties:
        limit:
          maximum: 1000
          minimum: 0
          type: integer
          format: int32
        offset:
          minimum: 0
          type: integer
          format: int32
        tenantId:
          type: string
        lastChangedSince:
          type: integer
          format: int64
        includeDeleted:
          type: boolean
    StockSearch:
      type: object
      properties:
        id:
          type: array
          items:
            type: string
        clientReferenceId:
          type: array
          items:
            type: string
        facilityId:
          maxLength: 64
          minLength: 2
          type: string
        productVariantId:
          type: array
          items:
            type: string
        referenceId:
          type: string
        wayBillNumber:
          type: array
          items:
            type: string
        referenceIdType:
          maxLength: 64
          minLength: 2
          type: string
        transactionType:
          type: string
          enum:
            - RECEIVED
            - DISPATCHED
        transactionReason:
          type: string
          enum:
            - RECEIVED
            - RETURNED
            - LOST_IN_STORAGE
            - LOST_IN_TRANSIT
            - DAMAGED_IN_STORAGE
            - DAMAGED_IN_TRANSIT
        transactingPartyId:
          maxLength: 64
          minLength: 2
          type: string
        transactingPartyType:
          type: string
    StockSearchRequest:
      required:
        - RequestInfo
        - Stock
      type: object
      properties:
        RequestInfo:
          $ref: '#/components/schemas/RequestInfo'
        Stock:
          $ref: '#/components/schemas/StockSearch'
    StockBulkResponse:
      required:
        - ResponseInfo
        - Stock
      type: object
      properties:
        ResponseInfo:
          $ref: '#/components/schemas/ResponseInfo'
        Stock:
          type: array
          items:
            $ref: '#/components/schemas/Stock'
        TotalCount:
          type: integer
          format: int64
    StockReconciliation:
      required:
        - facilityId
        - productVariantId
        - tenantId
      type: object
      properties:
        id:
          maxLength: 64
          minLength: 2
          type: string
        tenantId:
          maxLength: 1000
          minLength: 2
          type: string
        source:
          type: string
        rowVersion:
          type: integer
          format: int32
        applicationId:
          type: string
        hasErrors:
          type: boolean
        additionalFields:
          $ref: '#/components/schemas/AdditionalFields'
        auditDetails:
          $ref: '#/components/schemas/AuditDetails'
        clientReferenceId:
          maxLength: 64
          minLength: 2
          type: string
        clientAuditDetails:
          $ref: '#/components/schemas/AuditDetails'
        facilityId:
          maxLength: 64
          minLength: 2
          type: string
        productVariantId:
          maxLength: 64
          minLength: 2
          type: string
        referenceId:
          type: string
        referenceIdType:
          maxLength: 64
          minLength: 2
          type: string
        physicalCount:
          type: integer
          format: int32
        calculatedCount:
          type: integer
          format: int32
        commentsOnReconciliation:
          type: string
        dateOfReconciliation:
          type: integer
          format: int64
        isDeleted:
          type: boolean
    StockReconciliationBulkRequest:
      required:
        - RequestInfo
        - StockReconciliation
      type: object
      properties:
        RequestInfo:
          $ref: '#/components/schemas/RequestInfo'
        StockReconciliation:
          type: array
          items:
            $ref: '#/components/schemas/StockReconciliation'
    StockReconciliationRequest:
      required:
        - RequestInfo
        - StockReconciliation
      type: object
      properties:
        RequestInfo:
          $ref: '#/components/schemas/RequestInfo'
        StockReconciliation:
          $ref: '#/components/schemas/StockReconciliation'
    StockReconciliationResponse:
      required:
        - ResponseInfo
        - StockReconciliation
      type: object
      properties:
        ResponseInfo:
          $ref: '#/components/schemas/ResponseInfo'
        StockReconciliation:
          $ref: '#/components/schemas/StockReconciliation'
    StockReconciliationSearch:
      type: object
      properties:
        id:
          type: array
          items:
            type: string
        clientReferenceId:
          type: array
          items:
            type: string
        facilityId:
          type: array
          items:
            type: string
        productVariantId:
          type: array
          items:
            type: string
    StockReconciliationSearchRequest:
      required:
        - RequestInfo
        - StockReconciliation
      type: object
      properties:
        RequestInfo:
          $ref: '#/components/schemas/RequestInfo'
        StockReconciliation:
          $ref: '#/components/schemas/StockReconciliationSearch'
    StockReconciliationBulkResponse:
      required:
        - ResponseInfo
        - StockReconciliation
      type: object
      properties:
        ResponseInfo:
          $ref: '#/components/schemas/ResponseInfo'
        StockReconciliation:
          type: array
          items:
            $ref: '#/components/schemas/StockReconciliation'
        TotalCount:
          type: integer
          format: int64
