openapi: 3.0.1
info:
  title: Individual Registry
  version: v1.6
servers:
  - url: https://unified-dev.digit.org
    description: Development server url
paths:

  /individual/v1/_create:
    post:
      tags:
        - Individual
      operationId: individualV1CreatePost
      parameters:
        - name: echoResource
          in: query
          required: false
          schema:
            type: boolean
            default: true
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IndividualRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndividualResponse'
        '400':
          description: Bad Request
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
  /individual/v1/bulk/_create:
    post:
      tags:
        - Individual
      operationId: individualV1BulkCreatePost
      parameters:
        - name: echoResource
          in: query
          required: false
          schema:
            type: boolean
            default: true
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IndividualBulkRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ResponseInfo'
        '400':
          description: Bad Request
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
  /individual/v1/_update:
    post:
      tags:
        - Individual
      operationId: individualV1UpdatePost
      parameters:
        - name: echoResource
          in: query
          required: false
          schema:
            type: boolean
            default: true
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IndividualRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndividualResponse'
        '400':
          description: Bad Request
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
  /individual/v1/bulk/_update:
    post:
      tags:
        - Individual
      operationId: individualV1BulkUpdatePost
      parameters:
        - name: echoResource
          in: query
          required: false
          schema:
            type: boolean
            default: true
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IndividualBulkRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ResponseInfo'
        '400':
          description: Bad Request
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
  /individual/v1/_delete:
    post:
      tags:
        - Individual
      operationId: individualV1DeletePost
      parameters:
        - name: echoResource
          in: query
          required: false
          schema:
            type: boolean
            default: true
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IndividualRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndividualResponse'
        '400':
          description: Bad Request
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
  /individual/v1/bulk/_delete:
    post:
      tags:
        - Individual
      operationId: individualV1BulkDeletePost
      parameters:
        - name: echoResource
          in: query
          required: false
          schema:
            type: boolean
            default: true
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IndividualBulkRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ResponseInfo'
        '400':
          description: Bad Request
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
  /individual/v1/_search:
    post:
      tags:
        - Individual
      operationId: individualV1SearchPost
      parameters:
        - $ref: "#/components/parameters/limit"
        - $ref: "#/components/parameters/offset"
        - $ref: "#/components/parameters/tenantId"
        - $ref: "#/components/parameters/lastChangedSince"
        - $ref: "#/components/parameters/includeDeleted"
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IndividualSearchRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndividualBulkResponse'
        '400':
          description: Bad Request
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-1-1.yml#/definitions/ErrorRes

components:
  parameters:
    tenantId:
      name: tenantId
      in: query
      description: Unique id for a tenant.
      required: true
      schema:
        type: string
        format: varchar

    lastChangedSince:
      name: lastChangedSince
      in: query
      description: |
        Epoch of the time since when the changes on the object should be picked up. 
        Search results from this parameter should include both newly created objects 
        since this time as well as any modified objects since this time. 
      required: false
      schema:
        type: integer
        format: int64
  
    echoResource:
      name: echoResource
      in: query
      description: |
        Client can specify if the resource in request body needs to be sent back in the response.
      required: false
      schema:
        type: boolean
        default: true
  
    serverHandlesErrors:
      name: serverHandlesErrors
      in: query
      description: |
        Client can specify that it is incapable of handling any errors with the requests.
      required: false
      schema:
        type: boolean
        default: false
  
    limit:
      name: limit
      in: query
      description: Pagination - limit records in response
      required: true
      schema:
        type: integer
        minimum: 0
        maximum: 1000  # TODO: review
  
    offset:
      name: offset
      in: query
      description: Pagination - offset from which records should be returned in response
      required: true
      schema:
        type: integer
        minimum: 0
  
    includeDeleted:
      name: includeDeleted
      in: query
      description: Used in search APIs to specify if (soft) deleted records should be included in search results.
      required: false
      schema:
        type: boolean
        default: false


  schemas:
    AdditionalFields:
      type: object
      properties:
        schema:
          maxLength: 64
          minLength: 2
          type: string
        version:
          minimum: 1
          type: integer
          format: int32
        fields:
          type: array
          items:
            $ref: '#/components/schemas/Field'
    Address:
      required:
        - type
      type: object
      properties:
        id:
          maxLength: 64
          minLength: 2
          type: string
        clientReferenceId:
          maxLength: 64
          minLength: 2
          type: string
        individualId:
          maxLength: 64
          minLength: 2
          type: string
        tenantId:
          type: string
        doorNo:
          maxLength: 64
          minLength: 2
          type: string
        latitude:
          maximum: 90
          exclusiveMaximum: false
          minimum: -90
          exclusiveMinimum: false
          type: number
          format: double
        longitude:
          maximum: 180
          exclusiveMaximum: false
          minimum: -180
          exclusiveMinimum: false
          type: number
          format: double
        locationAccuracy:
          minimum: 0
          exclusiveMinimum: false
          type: number
          format: double
        type:
          type: string
          enum:
            - PERMANENT
            - CORRESPONDENCE
            - OTHER
        addressLine1:
          maxLength: 256
          minLength: 2
          type: string
        addressLine2:
          maxLength: 256
          minLength: 2
          type: string
        landmark:
          maxLength: 256
          minLength: 2
          type: string
        city:
          maxLength: 256
          minLength: 2
          type: string
        pincode:
          maxLength: 64
          minLength: 2
          type: string
        buildingName:
          maxLength: 256
          minLength: 2
          type: string
        street:
          maxLength: 256
          minLength: 2
          type: string
        locality:
          $ref: '#/components/schemas/Boundary'
        ward:
          $ref: '#/components/schemas/Boundary'
        isDeleted:
          type: boolean
        auditDetails:
          $ref: '#/components/schemas/AuditDetails'
    AuditDetails:
      type: object
      properties:
        createdBy:
          type: string
        lastModifiedBy:
          type: string
        createdTime:
          type: integer
          format: int64
        lastModifiedTime:
          type: integer
          format: int64
    Boundary:
      required:
        - code
      type: object
      properties:
        id:
          type: string
        tenantId:
          type: string
        code:
          type: string
        geometry:
          $ref: '#/components/schemas/JsonNode'
        auditDetails:
          $ref: '#/components/schemas/AuditDetails'
        additionalDetails:
          $ref: '#/components/schemas/JsonNode'
    Field:
      required:
        - key
        - value
      type: object
      properties:
        key:
          maxLength: 64
          minLength: 2
          type: string
        value:
          maxLength: 10000
          minLength: 1
          type: string
    Identifier:
      required:
        - identifierId
        - identifierType
      type: object
      properties:
        id:
          maxLength: 64
          minLength: 2
          type: string
        clientReferenceId:
          maxLength: 64
          minLength: 2
          type: string
        individualId:
          maxLength: 64
          minLength: 2
          type: string
        identifierType:
          maxLength: 64
          minLength: 2
          type: string
        identifierId:
          maxLength: 64
          minLength: 2
          type: string
        isDeleted:
          type: boolean
        auditDetails:
          $ref: '#/components/schemas/AuditDetails'
    Individual:
      required:
        - name
        - tenantId
      type: object
      properties:
        id:
          maxLength: 64
          minLength: 2
          type: string
        tenantId:
          maxLength: 1000
          minLength: 2
          type: string
        status:
          type: string
        source:
          type: string
        rowVersion:
          type: integer
          format: int32
        applicationId:
          type: string
        hasErrors:
          type: boolean
        additionalFields:
          $ref: '#/components/schemas/AdditionalFields'
        auditDetails:
          $ref: '#/components/schemas/AuditDetails'
        clientReferenceId:
          maxLength: 64
          minLength: 2
          type: string
        clientAuditDetails:
          $ref: '#/components/schemas/AuditDetails'
        individualId:
          maxLength: 64
          minLength: 2
          type: string
        userId:
          type: string
        userUuid:
          type: string
        name:
          $ref: '#/components/schemas/Name'
        dateOfBirth:
          type: string
          format: date-time
        gender:
          type: string
          enum:
            - MALE
            - FEMALE
            - OTHER
            - TRANSGENDER
        bloodGroup:
          type: string
          enum:
            - B+
            - B-
            - A+
            - A-
            - AB+
            - AB-
            - O-
            - O+
        mobileNumber:
          maxLength: 20
          minLength: 0
          type: string
        altContactNumber:
          maxLength: 16
          minLength: 0
          type: string
        email:
          maxLength: 200
          minLength: 5
          type: string
        address:
          maxItems: 3
          minItems: 0
          type: array
          items:
            $ref: '#/components/schemas/Address'
        fatherName:
          maxLength: 100
          minLength: 0
          type: string
        husbandName:
          maxLength: 100
          minLength: 0
          type: string
        relationship:
          maxLength: 100
          minLength: 1
          type: string
        identifiers:
          type: array
          items:
            $ref: '#/components/schemas/Identifier'
        skills:
          type: array
          items:
            $ref: '#/components/schemas/Skill'
        photo:
          type: string
        isDeleted:
          type: boolean
        isSystemUser:
          type: boolean
        isSystemUserActive:
          type: boolean
        userDetails:
          $ref: '#/components/schemas/UserDetails'
    IndividualBulkRequest:
      required:
        - Individuals
        - RequestInfo
      type: object
      properties:
        RequestInfo:
          $ref: '#/components/schemas/RequestInfo'
        Individuals:
          type: array
          items:
            $ref: '#/components/schemas/Individual'
    JsonNode:
      type: object
    Name:
      type: object
      properties:
        givenName:
          maxLength: 200
          minLength: 2
          type: string
        familyName:
          maxLength: 200
          minLength: 2
          type: string
        otherNames:
          maxLength: 200
          minLength: 0
          type: string
    PlainAccessRequest:
      type: object
      properties:
        recordId:
          type: string
        plainRequestFields:
          type: array
          items:
            type: string
    RequestInfo:
      type: object
      properties:
        apiId:
          type: string
        ver:
          type: string
        ts:
          type: integer
          format: int64
        action:
          type: string
        did:
          type: string
        key:
          type: string
        msgId:
          type: string
        authToken:
          type: string
        correlationId:
          type: string
        plainAccessRequest:
          $ref: '#/components/schemas/PlainAccessRequest'
        userInfo:
          $ref: '#/components/schemas/User'
    Role:
      type: object
      properties:
        name:
          type: string
        code:
          type: string
        description:
          type: string
        tenantId:
          type: string
    Skill:
      required:
        - type
      type: object
      properties:
        id:
          maxLength: 64
          minLength: 2
          type: string
        clientReferenceId:
          maxLength: 64
          minLength: 2
          type: string
        individualId:
          maxLength: 64
          minLength: 2
          type: string
        type:
          maxLength: 64
          minLength: 2
          type: string
        level:
          maxLength: 64
          minLength: 2
          type: string
        experience:
          maxLength: 64
          minLength: 2
          type: string
        isDeleted:
          type: boolean
        auditDetails:
          $ref: '#/components/schemas/AuditDetails'
    User:
      type: object
      properties:
        id:
          type: integer
          format: int64
        userName:
          type: string
        name:
          type: string
        type:
          type: string
        mobileNumber:
          type: string
        emailId:
          type: string
        roles:
          type: array
          items:
            $ref: '#/components/schemas/Role'
        tenantId:
          type: string
        uuid:
          type: string
    UserDetails:
      type: object
      properties:
        username:
          maxLength: 180
          minLength: 0
          type: string
        password:
          maxLength: 64
          minLength: 0
          type: string
        tenantId:
          maxLength: 1000
          minLength: 2
          type: string
        roles:
          type: array
          items:
            $ref: '#/components/schemas/Role'
        type:
          maxLength: 50
          minLength: 0
          type: string
          enum:
            - CITIZEN
            - EMPLOYEE
            - SYSTEM
            - BUSINESS
    ResponseInfo:
      type: object
      properties:
        apiId:
          type: string
        ver:
          type: string
        ts:
          type: integer
          format: int64
        resMsgId:
          type: string
        msgId:
          type: string
        status:
          type: string
    IndividualRequest:
      required:
        - Individual
        - RequestInfo
      type: object
      properties:
        RequestInfo:
          $ref: '#/components/schemas/RequestInfo'
        Individual:
          $ref: '#/components/schemas/Individual'
    IndividualResponse:
      required:
        - ResponseInfo
      type: object
      properties:
        ResponseInfo:
          $ref: '#/components/schemas/ResponseInfo'
        Individual:
          $ref: '#/components/schemas/Individual'
    URLParams:
      required:
        - limit
        - offset
        - tenantId
      type: object
      properties:
        limit:
          maximum: 1000
          minimum: 0
          type: integer
          format: int32
        offset:
          minimum: 0
          type: integer
          format: int32
        tenantId:
          type: string
        lastChangedSince:
          type: integer
          format: int64
        includeDeleted:
          type: boolean
    IndividualSearch:
      type: object
      properties:
        id:
          type: array
          items:
            type: string
        clientReferenceId:
          type: array
          items:
            type: string
        individualId:
          type: array
          items:
            type: string
        name:
          $ref: '#/components/schemas/Name'
        dateOfBirth:
          type: string
          format: date-time
        gender:
          type: string
          enum:
            - MALE
            - FEMALE
            - OTHER
            - TRANSGENDER
        mobileNumber:
          type: array
          items:
            type: string
        socialCategory:
          type: string
        wardCode:
          type: string
        individualName:
          type: string
        createdFrom:
          type: number
        createdTo:
          type: number
        identifier:
          $ref: '#/components/schemas/Identifier'
        boundaryCode:
          type: string
        roleCodes:
          type: array
          items:
            type: string
        username:
          type: array
          items:
            type: string
        userId:
          type: array
          items:
            type: integer
            format: int64
        userUuid:
          type: array
          items:
            type: string
        latitude:
          maximum: 90
          exclusiveMaximum: false
          minimum: -90
          exclusiveMinimum: false
          type: number
          format: double
        longitude:
          maximum: 180
          exclusiveMaximum: false
          minimum: -180
          exclusiveMinimum: false
          type: number
          format: double
        searchRadius:
          minimum: 0
          exclusiveMinimum: false
          type: number
          format: double
        type:
          type: string
    IndividualSearchRequest:
      required:
        - Individual
        - RequestInfo
      type: object
      properties:
        RequestInfo:
          $ref: '#/components/schemas/RequestInfo'
        Individual:
          $ref: '#/components/schemas/IndividualSearch'
    IndividualBulkResponse:
      required:
        - ResponseInfo
      type: object
      properties:
        ResponseInfo:
          $ref: '#/components/schemas/ResponseInfo'
        TotalCount:
          type: integer
          format: int64
        Individual:
          type: array
          items:
            $ref: '#/components/schemas/Individual'
